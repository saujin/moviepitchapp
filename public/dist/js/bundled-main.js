!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";moviePitchApp.controller("MainController",["$scope","ModalService","$timeout",function($scope,ModalService,$timeout){function openModalTasks(){$(".modal-close-animation").removeClass("modal-close-animation")}function closeModalTasks(modal){$scope.isModalShown="modal-shown",modal.close.then(function(result){$scope.isModalShown="modal-hidden"})}function populateFancySelect(id){function selectReady(){var numOptions=$select.find("option").length;numOptions>1?$select.fancySelect():$timeout(selectReady,50)}var $select=$(id);selectReady()}$scope.isModalShown="modal-hidden",$scope.scrollToLink=function(id){var offset=$(id).offset().top;return $("html, body").animate({scrollTop:offset},500),!1},$scope.showPitchModal=function(){openModalTasks(),ModalService.showModal({controller:"PitchModalController",templateUrl:"src/modals/pitch-modal/pitch-modal.html"}).then(function(modal){populateFancySelect("#select-genre"),closeModalTasks(modal)})},$scope.showExampleModal=function(){$(".modal-close-animation").removeClass("modal-close-animation"),ModalService.showModal({controller:"CustomModalController",templateUrl:"src/modals/examples-modal/examples-modal.html"}).then(function(modal){closeModalTasks(modal)})}}]),moviePitchApp.controller("PitchModalController",["$scope","close",function($scope,close){$scope.dismissModal=function(){$("#modal-bg").addClass("modal-close-animation"),close("Modal Dismissed",500)}}]),moviePitchApp.controller("CustomModalController",["$scope","close",function($scope,close){$scope.dismissModal=function(){$("#modal-bg").addClass("modal-close-animation"),close("Modal Dismissed",500)}}]),moviePitchApp.factory("adminFactory",function($http){var urlBase="https://moviepitchapi.herokuapp.com",testUser={name:"Justin Tulk",email:"justintulk@gmail.com",pwd:"testPassword"},factory={loginAdmin:function(email,pwd){return $http({method:"POST",url:urlBase+"/admin/login",data:{email:email,password:pwd}})},registerAdmin:function(data){return $http({method:"POST",url:urlBase+"/admin/register",data:{name:data.name,email:data.email,password:data.pwd}})},testLoginAdmin:function(){return $http({method:"POST",url:urlBase+"/admin/login",data:{email:testUser.email,password:testUser.pwd}})},testRegisterAdmin:function(){return $http({method:"POST",url:urlBase+"/admin/register",data:{name:testUser.name,email:testUser.email,password:testUser.pwd}})}};return factory}),moviePitchApp.factory("emailFactory",function($q){var factory={sendContactUsMessage:function(name,email,subject,msg){var deferred=$q.defer();return deferred.resolve({status:"success",name:name,email:email,subject:subject,message:msg}),deferred.promise},validateEmail:function(email){var deferred=$q.defer(),reg=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;return reg.test(email)?deferred.resolve(!0):deferred.reject(!1),deferred.promise}};return factory}),moviePitchApp.factory("paymentFactory",function($http){var urlBase="https://moviepitchapi.herokuapp.com",factory={createCharge:function(amount,description,token){return console.log({amount:amount,description:description,currency:"usd",source:token}),$http({method:"POST",url:urlBase+"/stripe/create_charge",data:{amount:amount,description:description,currency:"usd",source:token}})}};return factory}),moviePitchApp.factory("pitchFactory",function($q,$http){var urlBase="https://moviepitchapi.herokuapp.com",factory={acceptPitch:function(id){return $http({type:"GET",url:urlBase+"/pitch/accept/"+id})},getAllPitches:function(){return $http({method:"GET",url:urlBase+"/pitch"})},getPitchByFilter:function(filterString){return $http({method:"GET",url:urlBase+"/pitch?"+filterString})},getPitchByID:function(id){return $http({method:"GET",url:urlBase+"/pitch/"+id})},lockPitch:function(id){return $http({method:"GET",url:urlBase+"/pitch/lock/"+id})},rejectPitch:function(id){return $http({type:"GET",url:urlBase+"/pitch/reject/"+id})},submitPitch:function(pitch){return $http({method:"POST",url:urlBase+"/pitch",data:pitch})},validatePitch:function(pitch){var deferred=$q.defer();return console.log(pitch),pitch.userHasAcceptedTerms===!0&&""!==pitch.pitchText&&"Select Genre"!==pitch.genre&&""!==pitch.genre?(pitch.status="created",pitch.userHasAcceptedTime=new Date,deferred.resolve({status:"success",pitch:pitch})):""===pitch.pitchText&&pitch.userHasAcceptedTerms===!1&&"Select Genre"===pitch.genre?deferred.reject({status:"error",errorCode:1e3,msg:"Please fill out the pitch form before submitting."}):""===pitch.genre||"Select Genre"===pitch.genre?deferred.reject({status:"error",errorCode:1001,msg:"Please select a genre."}):""===pitch.pitchText||null===pitch.pitchText?deferred.reject({status:"error",errorCode:1002,msg:"Please write your movie idea in the textarea."}):pitch.userHasAcceptedTerms===!1?deferred.reject({status:"error",errorCode:1003,msg:"Please accept the terms in order to continue."}):deferred.reject({status:"error",errorCode:1010,msg:"Something has gone wrong. Please refresh the page."}),deferred.promise}};return factory}),moviePitchApp.factory("userFactory",function($q,$rootScope,$location){var factory={checkLoggedIn:function(){var deferred=$q.defer();return null===$rootScope.curUser?(console.log("1"),deferred.reject(),$location.url("/login")):(console.log("2"),deferred.resolve()),deferred.promise},loginUser:function(username,pwd){var deferred=$q.defer();return Parse.User.logIn(username,pwd).then(function(user){$rootScope.curUser=user,deferred.resolve({status:"success",data:user}),$rootScope.$broadcast("login-update")},function(err){deferred.reject({status:"error",error:err})}),deferred.promise},logoutUser:function(){var deferred=$q.defer();Parse.User.logOut();var user=Parse.User.current();return null===user?($rootScope.curUser=null,$rootScope.$broadcast("logout-update"),deferred.resolve({status:"success",msg:"User is logged out"})):deferred.reject({status:"error",msg:"User is still logged in"}),deferred.promise},signUp:function(username,email,pwd){var deferred=$q.defer(),user=new Parse.User;return user.set("username",username),user.set("email",email),user.set("password",pwd),user.signUp(null,{success:function(user){deferred.resolve({status:"success",data:user}),console.log(Parse.User.current())},error:function(user,err){console.log(err),deferred.reject({status:"error",user:user,error:err})}}),deferred.promise}};return factory}),moviePitchApp.directive("adminPitchReview",function(){return{controller:function($scope){$scope.pitches=[{pitchDate:"November 3rd, 2015",genre:"Romantic Comedy",pitchText:"A man falls in love with a lady, but it's funny.",status:"rejected"},{pitchDate:"October 23rd, 2015",genre:"Horror",pitchText:"A woman keeps checking her fridge, but there's never anything worth eating.",status:"rejected"},{pitchDate:"June 3rd, 2015",genre:"Western",pitchText:"Some cowboys ride around chasing a gang of thieves",status:"accepted"}]},restrict:"A"}}),moviePitchApp.directive("contactUsForm",function(emailFactory,$timeout){return{controller:function($scope){$scope.data={name:"",email:"",msgSubject:"General",message:"",subjects:["General","Billing","Sales","Support"],errors:{email:!0,username:!0,message:!0}},$scope.btnState="btn--inactive",$scope.btnStateChange=function(){console.log($scope.data.errors),$scope.data.errors.email===!0||$scope.data.errors.username===!0||$scope.data.errors.message===!0?$scope.btnState="btn--inactive":$scope.btnState=""},$scope.validateName=function(){console.log("validating name"),""===$scope.data.name?$scope.data.errors.username=!0:$scope.data.errors.username=!1},$scope.validateEmail=function(){console.log("validating email"),emailFactory.validateEmail($scope.data.email).then(function(resp){$scope.data.errors.email=!1},function(err){$scope.data.errors.email=!0})},$scope.validateMsg=function(){console.log("validating message"),""===$scope.data.name?$scope.data.errors.message=!0:$scope.data.errors.message=!1};var clearErrors=function(){$scope.messageError="",$scope.submitSuccess=""},clearFields=function(){$scope.data.name=null,$scope.data.email=null,$scope.data.message=null,$scope.data.msgSubject="General",$scope.btnState="btn--inactive"};$scope.submitContactForm=function(){"btn--inactive"===$scope.btnState?console.log("inactive"):(clearErrors(),emailFactory.sendContactUsMessage($scope.data.name,$scope.data.email,$scope.data.msgSubject,$scope.data.message).then(function(resp){clearErrors(),clearFields(),$scope.submitSuccess="show-alert",$scope.successText="Success! Your message has been submitted.",$timeout(function(){$scope.submitSuccess="",$scope.successText=""},4e3)},function(err){$scope.errorText="An error has occurred. Your message was not sent.",$scope.messageError="show-alert"}),console.log($scope.data))}},link:function(scope,el,attrs){function selectReady(){var numOptions=$select.find("option").length;numOptions>1?$select.fancySelect():$timeout(selectReady,50)}var $select=$("#contact-subject");selectReady()},restrict:"A",templateUrl:"src/components/contact-us-form/contact-us-form.html"}}),moviePitchApp.directive("loginModal",function($rootScope,$state){return{controller:function($scope,userFactory){$scope.inputsError="",$scope.clearInputErrors=function(){$scope.inputsError=""},$scope.flagInputErrors=function(){$scope.inputsError="is-error"},$scope.isAlertShown="alert-hidden",$scope.hideAlert=function(){$scope.isAlertShown="alert-hidden"},$scope.showAlert=function(){$scope.isAlertShown="alert-shown"},$scope.clearForms=function(){var modal=$("#login-modal");modal.find("input").val(""),$scope.clearInputErrors()},$scope.userLogin=function(){var user,pwd;$("#login-modal");user=angular.element(document.getElementById("login-username")).val(),pwd=angular.element(document.getElementById("login-password")).val(),userFactory.loginUser(user,pwd).then(function(resp){$("#login-modal").modal("hide"),$scope.clearInputErrors(),$scope.clearForms(),$scope.hideAlert(),null!==$rootScope.targetState&&($state.go($rootScope.targetState),$rootScope.targetState=null)},function(err){$scope.flagInputErrors(),$scope.showAlert()})}},restrict:"E",templateUrl:"src/components/login-modal/login-modal.html"}}),moviePitchApp.directive("login",function(){return{controller:function($scope,userFactory){$scope.loginUser=function(){var user,pwd;user=angular.element(document.getElementById("user-login-username")).val(),pwd=angular.element(document.getElementById("user-login-pwd")).val(),userFactory.loginUser(user,pwd).then(function(resp){console.log(resp)},function(err){console.log(err)})},$scope.logoutUser=function(){userFactory.logoutUser().then(function(resp){console.log(resp)},function(err){console.log(err)})}},restrict:"E",templateUrl:"src/components/login/login.html"}}),moviePitchApp.directive("labelWrapper",function(){return{controller:function($scope){$scope.labelState=""},link:function(scope,el,attrs){var $inputs=el.find("input, select, textarea"),$label=el.find("label");$inputs.on("focus",function(){$label.addClass("label-wrapper-label--out")}),$inputs.on("blur",function(){var value=$($inputs[0]).val();""===value&&$label.removeClass("label-wrapper-label--out")})},restrict:"A"}}),moviePitchApp.directive("appHeader",function($state){return{controller:function($scope,userFactory){$scope.menuToggleStatus="menu-closed",$scope.currentLogAction="show-login",$scope.toggleMenu=function(){$scope.menuToggleStatus="menu-closed"===$scope.menuToggleStatus?"menu-open":"menu-closed"},$scope.$on("login-update",function(){$scope.currentLogAction="show-logout"}),$scope.$on("logout-update",function(){$scope.currentLogAction="show-login"}),$scope.logoutUser=function(){userFactory.logoutUser().then(function(resp){console.log(resp),$state.go("index")},function(err){console.log(err)})},$scope.openLoginModal=function(){}},link:function(scope,el,attrs){},restrict:"A",templateUrl:"src/components/nav/nav.html"}}),moviePitchApp.directive("signup",function(){return{controller:function($scope,$timeout,$state,$rootScope,userFactory,emailFactory){$scope.validateEmail=function(){var email=angular.element(document.getElementById("register-email")).val();emailFactory.validateEmail(email).then(function(resp){$scope.emailError=""},function(err){$scope.emailErrorText="Please enter a valid email address.",$scope.emailError="show-alert"})},$scope.signupUser=function(){var username,email,pwd,confirmPwd,testArray=[];username=angular.element(document.getElementById("register-username")).val(),email=angular.element(document.getElementById("register-email")).val(),pwd=angular.element(document.getElementById("register-password")).val(),confirmPwd=angular.element(document.getElementById("register-confirm-password")).val(),""===username||""===email||""===pwd?($scope.generalError="show-alert",testArray.push(!1)):$scope.generalError="",pwd!==confirmPwd?($scope.passwordError="show-alert",testArray.push(!1)):$scope.passwordError="",0===testArray.length&&userFactory.signUp(username,email,pwd).then(function(resp){$rootScope.$broadcast("login-update"),$scope.signupSuccess="show-alert",userFactory.loginUser(username,pwd).then(function(resp){$timeout(function(){$state.go("submit-pitch")},550)},function(err){console.log(err)})},function(err){switch(err.error.code){case-1:$scope.usernameErrorText="The username field is empty.",$scope.usernameError="show-alert";break;case 202:$scope.usernameErrorText="The desired username is already taken.",$scope.usernameError="show-alert";break;case 203:$scope.emailErrorText="An account has already been created at "+email+".",$scope.emailError="show-alert";default:console.log("uncaught error")}})}},restrict:"E",templateUrl:"src/components/signup/signup.html"}}),moviePitchApp.directive("successCarousel",function(){return{controller:function($scope){$scope.index=1,$scope.stories=[{name:"Emily Lloyd",text:"A grandmother from Ozark, Arkansas, sent Bob an index card about a man who lived in the Statue of Liberty. He sold the project to Universal Studios. Ryan Murphy (GLEE) wrote the script. “I can’t believe Bob was able to sell my one line idea. He was great to work with. I can’t wait to send him more.”"},{name:"David Simon",text:"I brought my original idea ‘The High School Security Tapes’ to Bob. He not only sold it to DreamWorks, he also made sure I got to write the screenplay. Since then, he sold another idea with Katherine Heigl to Fox 2000 and another with director Todd Phillips (THE HANGOVER) to Warner Brothers."},{name:"Tom Newman",text:"I was living in London when I heard about Bob Kosberg. I sent him a one page outline called ‘The Beauty Contest.’ Within one week, Bob had attached Meg Ryan to star and sold the project to New Line."},{name:"Steve List",text:"I attended one of Bob’s pitch events. I literally pitched Bob a thirty second story while we walked through the lobby. Bob had Paramount and Fox interested in buying my pitch and soon we had Drew Barrymore attached and I began writing the script at Fox Studios. I now have a writing career in Hollywood and it all started with Bob; he believed in my project and set it up at a studio."}],$scope.length=$scope.stories.length,$scope.carouselClass="test",$scope.moveCarousel=function(dir){var curIndex=$scope.index,maxLength=$scope.length;1===dir&&curIndex===maxLength?$scope.index=1:-1===dir&&1===curIndex?$scope.index=maxLength:$scope.index=$scope.index+dir,$scope.carouselClass="carousel-"+$scope.index}},restrict:"A",templateUrl:"src/components/success-carousel/success-carousel.html"}}),moviePitchApp.directive("userPitches",function(){return{controller:function($scope,userFactory){$scope.pitches=[{pitchDate:"November 3rd, 2015",genre:"Romantic Comedy",pitchText:"A man falls in love with a lady, but it's funny.",status:"rejected"},{pitchDate:"October 23rd, 2015",genre:"Horror",pitchText:"A woman keeps checking her fridge, but there's never anything worth eating.",status:"rejected"},{pitchDate:"June 3rd, 2015",genre:"Western",pitchText:"Some cowboys ride around chasing a gang of thieves",status:"accepted"}]},restrict:"E",templateUrl:"src/components/user-pitches/user-pitches.html"}})},{}]},{},[1]);